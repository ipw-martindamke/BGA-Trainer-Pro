<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%234F6BFF"/><text x="50" y="66" font-size="60" text-anchor="middle" fill="white" font-family="Arial">B</text></svg>' type="image/svg+xml'>
  <title>BGA-Trainer Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
    }
    
    .card {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      padding: 24px;
      margin-bottom: 20px;
    }
    
    .header {
      background: linear-gradient(90deg, #1e3a8a, #2563eb);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    
    .bga-table {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 16px;
    }
    
    .bga-item {
      position: relative;
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px;
      text-align: center;
    }
    .bga-item label {
      display: block;
      font-size: 0.875rem;
      color: #4b5563;
      font-weight: 500;
    }
    .bga-item input {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      width: 100%;
      border: none;
      background: transparent;
      text-align: center;
      padding: 4px 0 0;
      outline: none;
    }
    
    .bga-item.norm-green { border-color: #10b981; background-color: #f0fdf4; }
    .bga-item.norm-red { border-color: #ef4444; background-color: #fef2f2; }
    .bga-item.norm-blue { border-color: #3b82f6; background-color: #eff6ff; }

    .tooltip {
      position: absolute;
      top: 2px;
      right: 5px;
      cursor: help;
      color: #9ca3af;
    }
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 220px;
      background-color: #111827;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 10;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.75rem;
    }
    .tooltip:hover .tooltip-text,
    .tooltip:focus .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .response-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    @media (min-width: 640px) {
      .response-list.two-col {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .response-list li {
      margin: 0;
    }
    .response-list input[type="radio"] {
      display: none;
    }
    .response-list label {
      display: block;
      padding: 16px;
      min-height: 48px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      background-color: #f3f4f6;
      color: #374151;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }
    
    .response-list input[type="radio"]:checked + label {
      background-color: #3b82f6;
      color: white;
      border-color: #2563eb;
    }
    
    .response-list input[type="radio"]:disabled + label,
    fieldset:disabled .response-list label {
        background-color: #f3f4f6;
        color: #9ca3af;
        cursor: not-allowed;
        border-color: #e5e7eb;
    }

    .btn {
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }
    .btn-primary {
      background-color: #2563eb;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1d4ed8;
    }
    .btn-secondary {
      background-color: #e5e7eb;
      color: #374151;
    }
    .btn-secondary:hover {
      background-color: #d1d5db;
    }

    .mode-switch {
      display: flex;
      border-radius: 8px;
      background-color: #e5e7eb;
      padding: 4px;
      width: fit-content;
    }
    .mode-switch input[type="radio"] {
      display: none;
    }
    .mode-switch label {
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      color: #4b5563;
      transition: all 0.2s ease;
    }
    .mode-switch input[type="radio"]:checked + label {
      background-color: #ffffff;
      color: #111827;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    details {
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      margin-bottom: 16px;
    }
    details summary {
      padding: 16px;
      cursor: pointer;
      font-weight: 600;
      color: #1f2937;
      list-style: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    details summary::-webkit-details-marker {
      display: none;
    }
    details .content {
      padding: 0 16px 16px;
      border-top: 1px solid #e5e7eb;
    }
    
    .clinical-explanation {
      background-color: #eff6ff;
      border: 1px solid #3b82f6;
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
    }
    .clinical-explanation h4 {
      margin: 0 0 8px;
      color: #1e40af;
      font-size: 0.95rem;
    }
    .clinical-explanation p {
      margin: 0 0 8px;
      font-size: 0.875rem;
      line-height: 1.5;
    }
    
    .hidden {
      display: none;
    }
    
    /* Sprint 2: Dashboard Styles */
    .stats-section {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }
    
    .stats-section h3 {
      margin: 0 0 12px 0;
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }
    
    .stat-item {
      background: rgba(255, 255, 255, 0.15);
      padding: 12px;
      border-radius: 6px;
    }
    
    .stat-label {
      font-size: 0.85rem;
      opacity: 0.9;
      margin-bottom: 4px;
    }
    
    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
    }
    
    .progress-bar-container {
      background: rgba(255, 255, 255, 0.2);
      height: 24px;
      border-radius: 12px;
      overflow: hidden;
      margin: 8px 0;
      position: relative;
    }
    
    .progress-bar {
      height: 100%;
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .progress-bar.excellent { background: #10b981; }
    .progress-bar.good { background: #f59e0b; }
    .progress-bar.needs-work { background: #ef4444; }
    
    .recommendation-card {
      background: rgba(255, 255, 255, 0.15);
      border-left: 4px solid #fbbf24;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    
    .recommendation-card h4 {
      margin: 0 0 6px 0;
      font-size: 0.95rem;
    }
    
    .recommendation-card p {
      margin: 0;
      font-size: 0.85rem;
      opacity: 0.9;
    }
    
    /* Tutorial Styles */
    .tutorial-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s;
    }
    
    .tutorial-card {
      background: white;
      border-radius: 16px;
      padding: 32px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
      animation: slideUp 0.5s;
      position: relative;
    }
    
    /* Mobile Optimierung */
    @media (max-width: 640px) {
      body { padding: 12px !important; }
      .card { padding: 16px; }
      .header { padding: 16px; }
      .bga-table { 
        grid-template-columns: repeat(2, 1fr);
        gap: 12px; 
      }
      .btn { 
        min-height: 44px;
        font-size: 16px;
        padding: 14px 20px;
      }
      .response-list.two-col {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 375px) {
      .tutorial-card {
        padding: 24px;
        max-width: 95%;
      }
      .bga-table {
        grid-template-columns: 1fr;
      }
      body { padding: 8px !important; }
    }
    
    .tutorial-progress {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      justify-content: center;
    }
    
    .tutorial-progress-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #e5e7eb;
      transition: all 0.3s;
    }
    
    .tutorial-progress-dot.active {
      background: #4F6BFF;
      width: 24px;
      border-radius: 5px;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

  </style>
</head>
<body class="p-4 md:p-8">

  <div class="max-w-3xl mx-auto">
    
    <header class="header">
      <div class="flex justify-between items-center">
        <h1 class="text-xl md:text-2xl font-bold">BGA-Trainer Pro</h1>
        <div class="flex gap-2 items-center">
          <div id="progress-badge" class="bg-white/20 text-white text-xs font-semibold px-3 py-1 rounded-full cursor-help" title="Klicken f√ºr Details">
            <span id="progress-text">Lade...</span>
          </div>
          <div id="mode-chip" class="bg-white/20 text-white text-xs font-semibold px-3 py-1 rounded-full">
            BASIS MODUS
          </div>
        </div>
      </div>
      <p class="text-sm text-white/80 mt-2">Systematisches BGA-Training f√ºr die Intensivpflege</p>
    </header>

    <div class="card flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div>
        <h2 class="text-lg font-semibold text-gray-800 m-0">Lern-Modus</h2>
        <p class="text-gray-600 m-0 text-sm">W√§hle deinen Erfahrungsgrad.</p>
      </div>
      <div class="flex gap-3 items-center flex-wrap">
        <div class="mode-switch" role="radiogroup" aria-label="Lern-Modus">
          <input type="radio" id="mode-basic" name="mode" value="basic" checked>
          <label for="mode-basic">Basis</label>
          <input type="radio" id="mode-advanced" name="mode" value="advanced">
          <label for="mode-advanced">Advanced</label>
          <input type="radio" id="mode-mixed" name="mode" value="mixed">
          <label for="mode-mixed">Mixed</label>
        </div>
        <button id="stats-toggle-btn" class="btn btn-secondary text-sm py-2 px-3" title="Zeige detaillierte Lernstatistiken" type="button" aria-expanded="false" aria-controls="stats-dashboard">
          üìä Statistiken
        </button>
      </div>
    </div>

    <!-- Dashboard Panel (initially hidden) -->
    <div id="stats-dashboard" class="card hidden" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold m-0">üìä Deine Lernstatistiken</h2>
        <button id="stats-close-btn" class="text-white hover:text-gray-200 text-2xl font-bold" style="background: none; border: none; cursor: pointer;" title="Schlie√üen" type="button">&times;</button>
      </div>
      
      <div id="stats-content" class="space-y-4">
        <!-- Wird dynamisch gef√ºllt -->
      </div>
    </div>

    <div class="card">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold text-gray-800 m-0">
          Fall #<span id="case-id">1</span>
        </h2>
        <span id="case-complexity" class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-800"></span>
      </div>

      <div id="clinical-context" class="mb-4 p-3 bg-blue-50 border-l-4 border-blue-500 text-sm text-gray-700 rounded">
        Klinischer Kontext wird hier angezeigt...
      </div>

      <h3 class="text-base font-semibold text-gray-700 mb-3">Grundwerte</h3>
      <div class="bga-table mb-4">
        <div class="bga-item" id="item-ph">
          <label for="ph">pH</label>
          <input type="number" id="ph" step="0.01" value="7.40" readonly>
          <div class="tooltip" tabindex="0">?
            <span class="tooltip-text">S√§ure-Basen-Status. Niedrig = Azidose, Hoch = Alkalose.</span>
          </div>
        </div>
        <div class="bga-item" id="item-pco2">
          <label for="pco2">pCO‚ÇÇ (mmHg)</label>
          <input type="number" id="pco2" step="0.1" value="40.0" readonly>
          <div class="tooltip" tabindex="0">?
            <span class="tooltip-text">Respiratorischer Parameter.</span>
          </div>
        </div>
        <div class="bga-item" id="item-hco3">
          <label for="hco3">HCO‚ÇÉ‚Åª (mmol/L)</label>
          <input type="number" id="hco3" step="0.1" value="24.0" readonly>
          <div class="tooltip" tabindex="0">?
            <span class="tooltip-text">Metabolischer Parameter.</span>
          </div>
        </div>
        <div class="bga-item" id="item-be">
          <label for="be">BE (mmol/L)</label>
          <input type="number" id="be" step="0.1" value="0.0" readonly>
          <div class="tooltip" tabindex="0">?
            <span class="tooltip-text">Base Excess.</span>
          </div>
        </div>
      </div>

      <div id="advanced-values-container" class="hidden">
        <h3 class="text-base font-semibold text-gray-700 mb-3">Erweiterte Werte</h3>
        <div class="bga-table">
          <div class="bga-item" id="item-laktat">
            <label for="laktat">Laktat (mmol/L)</label>
            <input type="number" id="laktat" step="0.1" value="1.0" readonly>
          </div>
          <div class="bga-item" id="item-na">
            <label for="na">Na‚Å∫ (mmol/L)</label>
            <input type="number" id="na" step="1" value="140" readonly>
          </div>
          <div class="bga-item" id="item-cl">
            <label for="cl">Cl‚Åª (mmol/L)</label>
            <input type="number" id="cl" step="1" value="105" readonly>
          </div>
          <div class="bga-item" id="item-k">
            <label for="k">K‚Å∫ (mmol/L)</label>
            <input type="number" id="k" step="0.1" value="4.0" readonly>
          </div>
          <div class="bga-item" id="item-glukose">
            <label for="glukose">Glukose (mg/dL)</label>
            <input type="number" id="glukose" step="1" value="100" readonly>
          </div>
        </div>
      </div>
      
    </div>
    
    <details>
      <summary>Normwerte (Spickzettel)</summary>
      <div class="content text-sm text-gray-700">
        <ul class="list-disc pl-5 space-y-1">
          <li><strong>pH:</strong> 7.35 ‚Äì 7.45</li>
          <li><strong>pCO‚ÇÇ:</strong> 35 ‚Äì 45 mmHg</li>
          <li><strong>HCO‚ÇÉ‚Åª:</strong> 22 ‚Äì 26 mmol/L</li>
          <li><strong>BE:</strong> -2 ‚Äì +2 mmol/L</li>
          <li><strong>Laktat:</strong> 0.5 ‚Äì 2.0 mmol/L</li>
          <li><strong>Na‚Å∫:</strong> 135 ‚Äì 145 mmol/L</li>
          <li><strong>Cl‚Åª:</strong> 98 ‚Äì 108 mmol/L</li>
          <li><strong>K‚Å∫:</strong> 3.5 ‚Äì 5.0 mmol/L</li>
          <li><strong>Glukose:</strong> 70 ‚Äì 110 mg/dL</li>
        </ul>
        <p class="mt-2 text-xs text-gray-500">Beachte: Normwerte k√∂nnen je nach Labor leicht abweichen.</p>
      </div>
    </details>

    <div class="card">
      <h2 class="text-lg font-semibold text-gray-800 m-0 mb-4">1. Prim√§re St√∂rung</h2>
      <fieldset id="primary-fieldset">
        <ul class="response-list two-col">
          <li><input type="radio" id="p-normal" name="primary" value="NORMAL"><label for="p-normal">Normal</label></li>
          <li><input type="radio" id="p-resp-aci" name="primary" value="RESP_ACI"><label for="p-resp-aci">Respiratorische Azidose</label></li>
          <li><input type="radio" id="p-resp-alk" name="primary" value="RESP_ALK"><label for="p-resp-alk">Respiratorische Alkalose</label></li>
          <li><input type="radio" id="p-met-aci" name="primary" value="MET_ACI"><label for="p-met-aci">Metabolische Azidose</label></li>
          <li><input type="radio" id="p-met-alk" name="primary" value="MET_ALK"><label for="p-met-alk">Metabolische Alkalose</label></li>
          <li id="p-mixed-li" class="hidden"><input type="radio" id="p-mixed" name="primary" value="P_MIXED"><label for="p-mixed">Gemischte St√∂rung</label></li>
        </ul>
      </fieldset>
    </div>

    <div class="card">
      <fieldset id="comp-basic-fieldset" disabled>
        <legend class="text-lg font-semibold text-gray-800 m-0 mb-4">2. Kompensation (Basis)</legend>
        <ul class="response-list">
          <li><input type="radio" id="c-none" name="comp_basic" value="NONE"><label for="c-none">Keine Kompensation</label></li>
          <li><input type="radio" id="c-partial" name="comp_basic" value="PARTIAL"><label for="c-partial">Teilweise kompensiert</label></li>
          <li><input type="radio" id="c-full" name="comp_basic" value="FULL"><label for="c-full">Vollst√§ndig kompensiert</label></li>
        </ul>
      </fieldset>
      
      <fieldset id="comp-advanced-fieldset" class="hidden" disabled>
        <legend class="text-lg font-semibold text-gray-800 m-0 mb-4">2. Kompensations-Analyse (Advanced)</legend>
        <ul class="response-list two-col">
          <li><input type="radio" id="ca-none" name="comp_advanced" value="NONE"><label for="ca-none">Keine Kompensation</label></li>
          <li><input type="radio" id="ca-resp-partial" name="comp_advanced" value="RESP_PARTIAL"><label for="ca-resp-partial">Respiratorische Teil-Komp.</label></li>
          <li><input type="radio" id="ca-met-partial" name="comp_advanced" value="MET_PARTIAL"><label for="ca-met-partial">Metabolische Teil-Komp.</label></li>
          <li><input type="radio" id="ca-resp-full" name="comp_advanced" value="RESP_FULL"><label for="ca-resp-full">Respiratorische Voll-Komp.</label></li>
          <li><input type="radio" id="ca-met-full" name="comp_advanced" value="MET_FULL"><label for="ca-met-full">Metabolische Voll-Komp.</label></li>
          <li><input type="radio" id="ca-mixed" name="comp_advanced" value="C_MIXED"><label for="ca-mixed">Gemischte St√∂rung</label></li>
        </ul>
      </fieldset>
    </div>

    <div class="card">
      <details id="explain-wrap" class="mb-4">
        <summary>
          <div class="flex items-center">
            <span id="status-dot" style="display:inline-block;width:12px;height:12px;border-radius:50%;margin-right:8px;background-color:#9ca3af;"></span>
            <span id="result-text">Bitte Werte auswerten</span>
          </div>
        </summary>
        <div class="content text-sm text-gray-700" id="explanation">
          Bitte w√§hle eine prim√§re St√∂rung und die Kompensation aus.
        </div>
      </details>
      
      <div id="clinical-explanation-container" class="hidden">
        <div class="clinical-explanation">
          <h4>üéì Klinische Bedeutung</h4>
          <div id="clinical-explanation-text"></div>
        </div>
      </div>

      <div class="flex flex-wrap gap-3 mt-4">
        <button id="evalbutton" class="btn btn-primary flex-1" type="button">Auswerten</button>
        <button id="resetbutton" class="btn btn-secondary" type="button">Zur√ºcksetzen</button>
        <button id="nextcasebutton" class="btn btn-secondary" type="button">N√§chster Fall</button>
      </div>
      
    </div>

  </div>

  <footer class="max-w-3xl mx-auto text-center text-xs text-gray-500 mt-8 mb-4 px-4">
    <p><strong>Wichtiger Hinweis (Haftungsausschluss):</strong><br>
    Dieses Tool dient ausschlie√ülich zu √úbungs- und Schulungszwecken. Die dargestellten F√§lle, Werte und Erkl√§rungen sind nicht zur Stellung medizinischer Diagnosen oder als Ersatz f√ºr eine klinische Untersuchung geeignet.</p>
    <p class="mt-4">
      <a href="#" onclick="showImpressum(); return false;" class="text-gray-600 hover:text-gray-800 underline">Impressum</a> ‚Ä¢ 
      <a href="#" onclick="showDatenschutz(); return false;" class="text-gray-600 hover:text-gray-800 underline">Datenschutz</a>
    </p>
    <p class="mt-4 text-gray-400" style="font-size: 0.65rem;">¬© 2025 Martin Damke | IpW GmbH ‚Äì Institut f√ºr pflegerische Weiterbildung</p>
  </footer>

  <script defer src="static/js/app.js"></script>
</body>
</html>
